<view class="page-background"></view>
<view class="container">
    <block wx:if="{{questions.length === 0}}">
        <view class="loading-box">
            <text>æ­£åœ¨åŠ è½½é¢˜ç›®...</text>
        </view>
    </block>
    
    <block wx:else>
        <view class="progress-header">
            <text class="count-label">å½“å‰è¿›åº¦</text>
            <text class="count-text main-color">ç¬¬ {{currentQuestionIndex + 1}} / {{questions.length}} é¢˜</text>
        </view>

        <view class="quiz-card-wrapper">
            <view class="question-title">
                {{currentQuestion.title}}
            </view>

            <view class="options-list">
                <view 
                    wx:for="{{currentQuestion.options}}" 
                    wx:key="*this" 
                    data-index="{{index}}"
                    bindtap="handleSelectOption"
                    class="option-item {{selectedOptionIndex === index ? 'selected' : ''}} {{isAnswerSubmitted && index === currentQuestion.answerIndex ? 'correct' : ''}} {{isAnswerSubmitted && selectedOptionIndex === index && selectedOptionIndex !== currentQuestion.answerIndex ? 'wrong' : ''}}"
                >
                    <view class="option-prefix">
                        <text>{{index + 1}}</text>
                        <block wx:if="{{isAnswerSubmitted}}">
                            <text wx:if="{{index === currentQuestion.answerIndex}}" class="icon-check">âœ…</text>
                            <text wx:elif="{{selectedOptionIndex === index && selectedOptionIndex !== currentQuestion.answerIndex}}" class="icon-cross">âŒ</text>
                        </block>
                    </view>
                    <text class="option-text">{{item}}</text>
                </view>
            </view>
        </view>
        
        <view class="action-area">
            <block wx:if="{{isAnswerSubmitted}}">
                <view class="explanation-box">
                    <view class="explanation-title">
                        <text wx:if="{{selectedOptionIndex === currentQuestion.answerIndex}}" class="result-text success-color">âœ… æ­å–œæ‚¨ï¼Œå›ç­”æ­£ç¡®ï¼</text>
                        <text wx:else class="result-text error-color">âŒ å¾ˆé—æ†¾ï¼Œå›ç­”é”™è¯¯ã€‚</text>
                    </view>
                    <view class="explanation-content">
                        <text class="explanation-label">è§£æï¼š</text>
                        {{currentQuestion.explanation}}
                    </view>
                </view>

                <button 
                    class="next-button" 
                    bindtap="handleNextQuestion"
                >
                    {{currentQuestionIndex === questions.length - 1 ? 'ğŸ‰ å®Œæˆé—®ç­”ï¼Œè¿›å…¥å°æ¸¸æˆ' : 'ä¸‹ä¸€é¢˜'}}
                </button>
            </block>

            <block wx:else>
                <button 
                    class="submit-button" 
                    bindtap="handleSubmitAnswer"
                    disabled="{{selectedOptionIndex === -1}}"
                >
                    æäº¤ç­”æ¡ˆ
                </button>
            </block>
        </view>
    </block>
</view>
